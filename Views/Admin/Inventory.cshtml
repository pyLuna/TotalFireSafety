@using TotalFireSafety.Models
@model Inventory
@{
    ViewBag.Title = "Inventory";
    Layout = "~/Views/AdminLayout.cshtml";
    ViewBag.Inv = "active";
}
<script src='@Url.Content("~/Scripts/validations/InventoryValidation.js")'></script>
<div class="main-content">
    <header>
        <h2>
            <label for="nav-toggle">
                <span class="las la-bars"></span>
            </label>
            Inventories
        </h2>
        <right>
            <button class="create-req-btn" title="CREATE ORDER">
                <a onclick="openForm()">
                    Notification
                    <span class="las la-bell"></span>
                    <label class="notif-badge" id="badge">0</label>
                </a>
            </button>
        </right>
    </header>

    <main>

        <div class="upper-section">
            <div class="search-wrapper">
                <span class="las la-search"></span>
                <input type="text" placeholder="Search here" onkeyup="SearchItem(this.value)">
            </div>
            &nbsp;
            <select id="selcat" onchange="SortByCategory(this,this.value)">
                <option disabled selected>Select Category</option>
                <option value="Fittings">Fittings</option>
                <option value="Gate Valves">Gate Valves</option>
                <option value="Power Tools">Power Tools</option>
                <option value="Fire Extinguisher">Fire Extinguisher</option>
                <option value="Scaffolding">Scaffolding</option>
                <option value="Others">Others</option>
                <option value="">Clear</option>
            </select>
        </div>

        <div class="inventory-grid">
            <div class="inventory-header" id="tableTitle">
                <h3>INVENTORY ITEMS</h3>
                <div class="inventory-buttons-style" id="hideBtn">

                    @*<button class="add-btn" title="ADD NEW ITEM" onclick="addOpenPopupInv() + setAttrib() + setDatalist()">ADD NEW ITEM</button>
                <button class="expo-btn" title="EXPORT REPORT" onclick="expoOpenPopup() + exportToPdf()">*@
                    @if (Int32.Parse(Session["system_role"].ToString()) == 2)
                    {
                        <button class="add-btn" title="ADD NEW ITEM" onclick="addOpenPopupInv() + AppendOption(addFormSel) + setDatalist();">ADD NEW ITEM</button>
                        @*<button class="add-btn" id="add_new_itm" title="ADD NEW ITEM">ADD NEW ITEM</button>*@
                        //+AppendOption(qtyFormSel)


                        <button class="qty-add-btn" title="ADD QUANTIY" onclick="qtyOpenPopupInv() + PopulateDataList()">ADD QUANTITY</button>
                        @*<button class="qty-add-btn" id="add_quan11" onclick="AppendOption(qtyFormSel)" title="ADD QUANTIY">ADD QUANTITY</button>*@
                    }
                    @* ADD REPORT *@
                    <button class="report-add-btn" title="ADD REPORT" onclick="reportOpenPopupInv() + PopulateDataList()">RE-ORDER</button>

                    <button class="expo-btn" id="expBtn" title="EXPORT REPORT">
                        @*+ expoOpenPopup()*@
                        <a href="@Url.Action("InventorylistExport", "Admin", new { id = ViewBag.EmpId })" target="_blank">
                            EXPORT
                            <span class="las la-file-download"></span>
                        </a>
                    </button>

                    @*<select id="filter" onchange="SortByCategory(this,this.value)">
                        <option disabled selected>FILTER</option>
                        <option value="standard">Standard</option>
                        <option value="average">Average</option>
                        <option value="critical">Critical</option>
                        <option value="">Clear</option>
                    </select>*@
                </div>
            </div>
            @if (Int32.Parse(Session["system_role"].ToString()) == 2)
            {

                <div class="add-popup-inv" id="add-popup-inv">
                    <div class="inventory-add-container">
                        <!-- Inventory Add -->
                        <div class="inventory-form-container">
                            <form action="/Admin/Inventory?type=add" method="post" id="addForm">
                                <div class="details-personal">
                                    <div class="inventory-form-header">
                                        ADD NEW ITEM
                                    </div>
                                    <div class="inventory-form-contents">
                                        <div class="fields">
                                            <div class="input-field">
                                                <label>Item ID</label>
                                                <input type="text" id="in_code" name="in_code" placeholder="ABC-DEF-GHI-000" readonly>
                                            </div>

                                            <div class="input-field">
                                                <label>Item Name</label>
                                                <input type="text" id="in_name" name="in_name" placeholder="Enter item name" required>
                                            </div>
                                            <div class="input-field">
                                                <label>Category</label>
                                                <input type="text" id="in_category" name="in_category" list="catlist" placeholder="Enter item Category" required>
                                                <datalist id="catlist"></datalist>
                                            </div>
                                            <div class="input-field">
                                                <label>Class</label>
                                                <select id="class" name="class" required>
                                                    <option value="" selected>Select Class</option>
                                                </select>
                                            </div>
                                            <input type="text" id="in_class" name="in_class" style="display:none;">
                                            <div class="input-field">
                                                <label>Type</label>
                                                <input type="text" id="in_type" list="typelist" name="in_type" placeholder="Enter item type">
                                                <datalist id="typelist"></datalist>
                                            </div>
                                            <div class="input-field">
                                                <label>Size</label>
                                                <div class="input-field-size">
                                                    <input type="number" id="inpSizeSel" name="inpSizeSel" placeholder="00000">
                                                    <select id="sizeSel" name="sizeSel">
                                                        <option value="" selected>Unit</option>
                                                    </select>
                                                </div>
                                                <label id="inpSizeSel-error" class="error manual-error" for="inpSizeSel"></label>
                                                <label id="SizeSel-error" class="error manual-error" for="SizeSel"></label>
                                            </div>
                                            <input type="text" id="in_size" name="in_size" style="display:none;" required>
                                            <div class="input-field">
                                                <label>Quantity</label>
                                                <div class="input-field-quantity">
                                                    <input type="number" id="inpSizeQuant" name="inpSizeQuant" placeholder="000" required>
                                                    <select id="sizeQuant" name="sizeQuant" required>
                                                        <option value="" selected>Unit</option>
                                                    </select>
                                                </div>
                                                <label id="inpSizeQuant-error" class="error manual-error" for="inpSizeQuant"></label>
                                                <label id="sizeQuant-error" class="error manual-error" for="sizeQuant"></label>
                                            </div>
                                            <div class="input-field">
                                                <label>Max Quantity</label>
                                                <input type="number" id="Inv_Limitsmaximum" name="Inv_Limits.maximum" placeholder="000">
                                            </div>
                                            <div class="input-field">
                                                <label>Min Quantity</label>
                                                <input type="number" id="Inv_Limitsminimum" name="Inv_Limits.minimum" placeholder="000">
                                            </div>
                                            <div class="input-field">
                                                <label>Reorder</label>
                                                <input type="number" id="Inv_Limitsreorder" name="Inv_Limits.reorder" placeholder="000">
                                            </div>
                                            <input type="text" id="in_quantity" name="in_quantity" style="display:none!important;" required>
                                            <input type="text" id="in_remarks" name="in_remarks" style="display:none;" required>
                                            <div class="input-field">
                                                <label>Date Added</label>
                                                <input type="text" id="dateAdded" name="in_dateAdded" readonly>
                                            </div>
                                            <div class="input-field">
                                                <div class="img-bar-grp" id="image-container">

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-add-btns">

                                    <button class="save" onclick="checkForm() + SetHiddenValues()">
                                        @*infoOpenPopup('addForm')*@
                                        <span class="btnText">Save</span>
                                        <i class="las la-check-square"></i>
                                    </button>

                                    <button type="reset" class="cancel" id="Add_itm-cancel">
                                        <span class="btnText" onclick="canOpenPopup()">Cancel</span>
                                        <i class="las la-window-close"></i>
                                    </button>
                                </div>

                            </form>
                        </div>
                    </div>
                </div>

                <div class="add-qty-popup-inv" id="add-qty-popup-inv">
                    <div class="inventory-add-container">

                        <!-- Inventory Add Quantity -->

                        <div class="inventory-form-container">
                            <form action="#" id="qtyForm" method="post">
                                <div class="details-personal">
                                    <div class="inventory-form-header">
                                        ADD QUANTITY
                                    </div>
                                    <div class="inventory-form-contents">

                                        <div class="add-qty-header">
                                            <div class="search-wrapper add-search">
                                                <span class="las la-search"></span>
                                                <input type="text" placeholder="Search here" list="codeList" id="srchcode">
                                                <datalist id="codeList">
                                                </datalist>
                                            </div>

                                            <div class="add-qty">
                                                <label>Quantity:</label>
                                                <input type="number" id="batchQuant" />
                                            </div>
                                        </div>
                                        <br />
                                        <label id="batchQuant-error" class="error manual-error" for="batchQuant"></label>

                                        <div class="item">
                                            <div class="item-header">
                                                <label>Item Codes:</label>
                                            </div>

                                            <div class="text-area" id="codeArea">
                                                @*<textarea id="dataTextarea" rows="10" cols="30" onkeydown="handleKeyDown(event)"></textarea>*@
                                                @*<div class="code-card">
                    <label>IMP-FXRT-FXRT</label>
                    <i class="las la-times-circle"></i>
                </div>
                <div class="code-card">
                    <label>IMP-FXRT-FXRT</label>
                    <i class="las la-times-circle"></i>
                </div>
                <div class="code-card">
                    <label>IMP-FXRT-FXRT</label>
                    <i class="las la-times-circle"></i>
                </div>*@
                                            </div>

                                        </div>





                                        @*<div class="fields">
            <div class="input-field">
                <label>Item ID</label>
                <input type="text" id="in_code1" name="in_code" placeholder="ABCD-EFG-HIJ" required>
            </div>
            <div class="input-field">
                <label>Item Name</label>
                <input type="text" id="in_name1" name="in_name" placeholder="Enter item name" readonly>
            </div>
            <div class="input-field">
                <label>Category</label>
                <select id="selcat1" disabled>
                    <option disabled selected>Select Category</option>
                </select>
            </div>
            <div class="input-field">
                <label>Class</label>
                <select id="selclass" disabled>
                    <option disabled selected>Select Class</option>
                </select>
            </div>
            <div class="input-field">
                <label>Type</label>
                <select id="seltype" disabled>
                    <option disabled selected>Select Type</option>
                </select>
            </div>
            <div class="input-field">
                <label>Size</label>
                <div class="input-field-size">
                    <input type="number" id="inpSize1" name="inpSize1" placeholder="00000" readonly>
                    <select id="inpSize" disabled>
                        <option disabled selected>Unit</option>
                    </select>
                </div>

            </div>
            <div class="input-field">
                <label>Quantity</label>
                <div class="input-field-quantity">
                    <input type="number" id="inpQuant1" name="inpQuant1" placeholder="000" required>
                    <select id="inpQuant" name="inpQuant">
                        <option value="" disabled selected>Unit</option>
                    </select>
                </div>
                <label id="inpQuant1-error" class="error manual-error" for="inpQuant1"></label>
            </div>
            <input type="text" id="in_category1" name="in_category" style="display:none;">
            <input type="text" id="in_class1" name="in_class" style="display:none;">
            <input type="text" id="in_type1" name="in_type" style="display:none;">
            <input type="text" id="in_size1" name="in_size" style="display:none;">
            <input type="text" id="in_quantity1" name="in_quantity" style="display:none;">
            <input type="text" id="in_remarks1" name="in_remarks" style="display:none;">
            <div class="input-field">
                <label>Date Added</label>
                <input type="text" id="inpDate" name="in_dateAdded" placeholder="00/00/00" readonly>
            </div>
            <div class="input-field">
                <div class="img-bar-grp" id="image-container">

                </div>
            </div>
        </div>*@
                                    </div>
                                </div>

                                <div class="form-add-btns">
                                    <button class="save" onclick="validateBatchQuantity()">
                                        @*onclick="setHiddens()"*@
                                        @*infoOpenPopup('qtyForm')*@
                                        <span class="btnText">Save</span>
                                        <i class="las la-check-square"></i>
                                    </button>

                                    <button class="cancel">
                                        <span class="btnText" onclick="canOpenPopup()">Cancel</span>
                                        <i class="las la-window-close"></i>
                                    </button>
                                </div>

                            </form>
                        </div>

                    </div>
                </div>


                <!-- ADD REPORT -->

                <div class="add-report-popup-inv" id="add-report-popup-inv">
                    <div class="inventory-add-container">

                        <!-- Inventory Add REPORT -->

                        <div class="inventory-form-container">
                            <form action="#" id="reportForm">
                                <div class="details-personal">
                                    <div class="inventory-form-header">
                                        ADD REPORT
                                    </div>
                                    <div class="inventory-form-contents">

                                        <div class="add-report-header">
                                            <div class="search-wrapper add-search">
                                                <span class="las la-search"></span>
                                                <input type="text" placeholder="Search here" list="codeList" id="srchcode">
                                                <datalist id="codeList">
                                                </datalist>
                                            </div>

                                            <div class="add-report">
                                                <label>Quantity:</label>
                                                <input type="number" max="999" id="batchQuant" />
                                            </div>
                                        </div>

                                        <div class="item">
                                            <div class="item-header">
                                                <label>Item Codes:</label>
                                            </div>

                                            <div class="text-area" id="codeArea">

                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-add-btns">
                                    <button class="save">
                                        @*onclick="setHiddens()"*@
                                        @*infoOpenPopup('qtyForm')*@
                                        <span class="btnText">Save</span>
                                        <i class="las la-check-square"></i>
                                    </button>

                                    <button class="cancel">
                                        <span class="btnText" onclick="canOpenPopup()">Cancel</span>
                                        <i class="las la-window-close"></i>
                                    </button>
                                </div>

                            </form>
                        </div>

                    </div>
                </div>

                <!-- END OF REPORT -->

                <div class="edit-item-popup-inv" id="edit-item-popup-inv">
                    <div class="inventory-add-container">

                        <!-- Inventory Edit -->

                        <div class="inventory-form-container">
                            <form action="/Admin/AddItem2?type=edit" method="post" id="editForm">
                                <div class="details-personal">
                                    <div class="inventory-form-header">
                                        EDIT ITEM
                                    </div>
                                    <div class="inventory-form-contents">
                                        <div class="fields">
                                            <div class="input-field">
                                                <label>Item ID</label>
                                                <input type="text" id="in_code2" name="in_code" placeholder="ABCD-EFG-HIJ" readonly>
                                            </div>

                                            <div class="input-field">
                                                <label>Item Name</label>
                                                <input type="text" id="in_name2" name="in_name" placeholder="Enter item name" readonly>
                                            </div>

                                            <div class="input-field">
                                                <label>Category</label>
                                                <input type="text" id="in_category2" name="in_category" list="catOpt" placeholder="Enter item Category" required>
                                                <datalist id="catOpt"></datalist>
                                                @*<select id="selcat2" name="selcat2" required>
                                                <option disabled selected>Select Category</option>
                                            </select>*@
                                            </div>

                                            <div class="input-field">
                                                <label>Class</label>
                                                <select id="selclass2" name="selclass2" required>
                                                    <option disabled selected>Select Category</option>
                                                </select>
                                            </div>

                                            <div class="input-field">
                                                <label>Type</label>
                                                <input type="text" id="in_type2" list="typeOpt" name="in_type" placeholder="Enter item type">
                                                <datalist id="typeOpt"></datalist>
                                                @*<select id="seltype2" name="seltype2">
                                                <option disabled selected>Select Category</option>
                                            </select>*@
                                            </div>

                                            <div class="input-field">
                                                <label>Size</label>
                                                <div class="input-field-size">
                                                    <input type="number" id="inpSize2" name="inpSize2" placeholder="00000">
                                                    <select id="inpSize2A" name="inpSize2A">
                                                        <option disabled selected>Measurement</option>
                                                    </select>
                                                </div>
                                                <label id="inpSize2-error" class="error manual-error" for="inpSize2" style=""></label>
                                            </div>
                                            <div class="input-field">
                                                <label>Quantity</label>
                                                <div class="input-field-quantity">
                                                    <input type="number" id="inpQuant2" name="inpQuant2" placeholder="000" readonly>
                                                    <select id="inpQuant2A" name="inpQuant2A" disabled>
                                                        <option disabled selected>Measurement</option>
                                                    </select>
                                                </div>
                                                <label id="inpQuant2-error" class="error manual-error" for="inpQuant2" style=""></label>
                                            </div>
                                            <input type="text" id="formType2" name="formType" style="display:none;">
                                            <input type="text" id="in_category2" name="in_category" style="display:none;">
                                            <input type="text" id="in_class2" name="in_class" style="display:none;">
                                            <input type="text" id="in_type2" name="in_type" style="display:none;">
                                            <input type="text" id="in_size2" name="in_size" style="display:none;">
                                            <input type="text" id="in_quantity2" name="in_quantity" style="display:none;">
                                            <input type="text" id="in_remarks2" name="in_remarks" style="display:none;">
                                            <div class="input-field">
                                                <label>Date Added</label>
                                                <input type="text" id="inpDate2" name="in_dateAdded" placeholder="00/00/00">
                                            </div>
                                            <div class="input-field">
                                                <div class="img-bar-grp" id="image-container">
                                                    @*<img src="~/images/barcode.png" alt="">*@
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-add-btns">
                                    <button class="save" onclick="setHiddensEdit() + checkForm_Edit_Itm()">
                                        @*infoOpenPopup('editForm')*@
                                        <span class="btnText">Save</span>
                                        <i class="las la-check-square"></i>
                                    </button>

                                    <button class="cancel">
                                        <span class="btnText" onclick="canOpenPopup()">Cancel</span>
                                        <i class="las la-window-close"></i>
                                    </button>
                                </div>

                            </form>
                        </div>
                    </div>
                </div>
            }

            <!-- INPUT POPUP -->

            <div class="inv-input-popup" id="inv-input-popup">
                <h3>INPUT QUANTITY</h3>
                <input type="number" id="quantVal" name="quantVal" required>
                <br />
                <p class="emErr" id="errMess" style="margin-top: 5px; color: red;"></p>
                <br>
                <br>
                <button id="conf">confirm</button>
                <button onclick="closeInvInputQTYForm()">cancel</button>
            </div>

            @* END *@

            <div class="inventory-projects" id="printable">
                <div class="inventory">
                    <div class="inventory-body">
                        <div class="table-responsive printable" style="overflow-x: auto;">
                            <table width="100%" id="myTable" class="myTable">
                                <thead>
                                    <tr>
                                        <td>Date Added</td>
                                        <td><a onclick="Sort(this,'in_code')">Code<i class="las la-sort-down"></i></a></td>
                                        <td><a onclick="Sort(this,'in_name')">Name<i class="las la-sort-down"></i></a></td>
                                        <td>Category</td>
                                        <td>Type</td>
                                        <td>Size</td>
                                        <td>On-hand Quantity</td>
                                        <td>Maximum<span title="This column shows the minimum quantity of the item"><i class="las la-info-circle"></i></span></td>
                                        <td>Minimum<span title="This column shows the maximum quantity of the item"><i class="las la-info-circle"></i></span></td>
                                        <td>Re-order<span title="This column shows the reorder point"><i class="las la-info-circle"></i></span></td>

                                        @*<td>Remarks<span title="Quantity &#10; Over 100 = Overstocked &#10; 50 to 99 = Standard &#10; 49 t0 30 = Average &#10; 29 to 10 = Reorder &#10; Below 9 = Critical"><i class="las la-info-circle"></i></span></td>*@

                                        <td><a onclick="Sort(this,'in_class')">Class<i class="las la-sort-down"></i></a></td>
                                        <td>Running Quantity</td>
                                        @if (Int32.Parse(Session["system_role"].ToString()) == 2)
                                        {
                                            <td id="hideAction">Action</td>
                                        }

                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        @* MOST REQUESTED FORM *@

        <div class="his-container" id="his-container">

            <div class="his-header">

                <button type="reset" style="border: none;">
                    <span class="las la-long-arrow-alt-left" onclick="closeHisForm()"></span>
                </button>
                <center>
                    <h3>ITEM HISTORY @*<i class="las la-rocket"></i>*@</h3>
                </center>

            </div>

            <div class="his-main">

                <div class="his-req">

                    <div class="his-req-contents">
                        <div class="his-req-table">
                            <div class="his-req-table-style">
                                <div class="table-responsive" style="overflow-x: auto;">
                                    <table width="100%" id="hisTable">
                                        <thead>
                                            <tr>
                                                <td>Date Added</td>
                                                <td>Item Code</td>
                                                <td>Item Name</td>
                                                <td>Quantity Added</td>
                                                <td>On-hand Quantity</td>
                                                <td>Total Quantity</td>
                                            </tr>
                                        </thead>

                                        <tbody>
                                            <tr>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>q

        </div>

        @* END *@


        <div class="info-pop-container" id="info-popup">
            <img src="@Url.Content("~/images/information.png")">
            <h2>System Warning!</h2>
            <p>Do you want to save the item on the list?</p>
            <button type="submit" id="saveForm">Yes</button>
            <button type="button" onclick="infoClosePopup()">Cancel</button>
        </div>

        <div class="del-pop-container" id="del-popup">
            <img src="@Url.Content("~/images/warning.png")">
            <h2>System Warning!</h2>
            <p>Are you sure you want to delete this item?</p>
            <button type="button" onclick="DeleteItem()">Yes</button>
            <button type="button" onclick="delClosePopup()">Cancel</button>
        </div>

        <div class="can-pop-container" id="can-popup">
            <img src="@Url.Content("~/images/warning.png")">
            <h2>System Warning!</h2>
            <p>Are you sure you want to cancel?</p>
            <button type="button" onclick="canClosePopup() + addClosePopupInv() + qtyClosePopupInv() + editClosePopupInv() + resetForm()">Yes</button>
            <button type="button" onclick="canClosePopup()">Cancel</button>
        </div>

        <div class="can-pop-container" id="can-popup">
            <img src="@Url.Content("~/images/warning.png")">
            <h2>System Warning!</h2>
            <p>Are you sure you want to cancel?</p>
            <button type="button" onclick="canClosePopup() + addClosePopupInv() + reportClosePopupInv() + editClosePopupInv() + resetForm()">Yes</button>
            <button type="button" onclick="canClosePopup()">Cancel</button>
        </div>

        <div class="rem-pop-container" id="rem-popup">
            <img src="@Url.Content("~/images/remove.png")">
            <h2>Deleted!</h2>
            <p>Item details has deleted in the list!</p>
            <button type="button" onclick="remClosePopup()">OK</button>
        </div>

        <div class="save-pop-container" id="save-popup">
            <img src="@Url.Content("~/images/tick.png")">
            <h2>Saved!</h2>
            <p id="updatemess"></p>
            @*<p>Item has saved successfully!</p>*@
            <button type="button" onclick="saveClosePopup()">OK</button>
        </div>

        <div class="print-pop-container" id="print-popup">
            <img src="@Url.Content("~/images/printer.png")">
            <h2>Print!</h2>
            <p>Print successfully!</p>
            <button type="button" onclick="printClosePopup()">OK</button>
        </div>

        <div class="expo-pop-container" id="expo-popup">
            <img src="@Url.Content("~/images/export.png")">
            <h2>Export!</h2>
            <p>Exported Successfully!</p>
            <button type="button" onclick="expoClosePopup()">OK</button>
        </div>

        @* POPUP FOR OVERSTACKED AND CRITICAL *@

        @*for add*@
        <div class="over-pop-container" id="over-popup">
            <img src="@Url.Content("~/images/information.png")">
            <h2>System Warning!</h2>
            <p>This item will be Overstacked. Do you want to proceed?</p>
            <button type="submit" id="addOverConf" onclick="infoOpenPopup('addForm') + closeOverPopup()">Yes</button>
            <button type="button" onclick="closeOverPopup()">Cancel</button>
        </div>

        <div class="over-pop-container" id="add-over-popup">
            <img src="@Url.Content("~/images/information.png")">
            <h2>System Warning!</h2>
            <p>This item will be marked as Critical. Are you sure?</p>
            <button type="submit" id="addCritConf" onclick="infoOpenPopup('addForm') + closeAddOverPopup()">Yes</button>
            <button type="button" onclick="closeAddOverPopup()">Cancel</button>
        </div>
        @*end add*@

        @*for quant*@
        <div class="over-pop-container" id="extra-over-popup">
            <img src="@Url.Content("~/images/information.png")">
            <h2>System Warning!</h2>
            <p>This item will be marked as Overstacked. Are you sure?</p>
            <button type="submit" id="qtyOverConf" onclick="infoOpenPopup('qtyForm') + closeExtraOverPopup()">Yes</button>
            <button type="button" onclick="closeExtraOverPopup()">Cancel</button>
        </div>

        <div class="crit-pop-container" id="crit-popup">
            <img src="@Url.Content("~/images/information.png")">
            <h2>System Warning!</h2>
            <p>This item will be marked as Critical. Are you sure?</p>
            <button type="submit" id="qtyCritConf">Yes</button>
            <button type="button" onclick="closeCritPopup()">Cancel</button>
        </div>
        @*end quant*@

        @*for report*@
        <div class="over-pop-container" id="extra-over-popup">
            <img src="@Url.Content("~/images/information.png")">
            <h2>System Warning!</h2>
            <p>This item will be marked as Overstacked. Are you sure?</p>
            <button type="submit" id="qtyOverConf" onclick="infoOpenPopup('reportForm') + closeExtraOverPopup()">Yes</button>
            <button type="button" onclick="closeExtraOverPopup()">Cancel</button>
        </div>

        <div class="crit-pop-container" id="crit-popup">
            <img src="@Url.Content("~/images/information.png")">
            <h2>System Warning!</h2>
            <p>This item will be marked as Critical. Are you sure?</p>
            <button type="submit" id="qtyCritConf">Yes</button>
            <button type="button" onclick="closeCritPopup()">Cancel</button>
        </div>
        @*end report*@

        @*for edit*@
        <div class="over-pop-container" id="edit-over-popup">
            <img src="@Url.Content("~/images/information.png")">
            <h2>System Warning!</h2>
            <p>This item will be marked as Overstacked. Are you sure?</p>
            <button type="submit" id="EditOverConf" onclick="infoOpenPopup('editForm') + closeExtraOverPopup()">Yes</button>
            <button type="button" onclick="closeExtraOverPopupEdit()">Cancel</button>
        </div>

        <div class="crit-pop-container" id="edit-crit-popup">
            <img src="@Url.Content("~/images/information.png")">
            <h2>System Warning!</h2>
            <p>This item will be marked as Critical. Are you sure?</p>
            <button type="submit" id="EditCritConf">Yes</button>
            <button type="button" onclick="closeCritPopupEdit()">Cancel</button>
        </div>
        @*end edit*@

        @* END *@

    </main>
</div>
<script src="@Url.Content("~/Scripts/Inventory.js")"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
<script>
    document.getElementById('expBtn').addEventListener("click", function () {
        localStorage.setItem("allItems", JSON.stringify(fixedArray));
        /*window.location.href = "/Admin/InventorylistExport";*/
    });

    /*ADD NEW ITEM CHECKFORM VALIDATION*/
    function checkForm() {
        var bool = $('#addForm').valid();
        if (bool) {
            var input = document.getElementById("inpSizeQuant").value;
            var max = document.getElementById("Inv_Limitsmaximum").value;
            var min = document.getElementById("Inv_Limitsreorder").value;
            var err = document.getElementById("inpSizeQuant-error");
            if (Number(input) > Number(max)) {
                err.innerText = "Quantity must not exceed maximum";
                err.style.display = "block";
                //openOverPopup();
                return;
            }
            else if (Number(input) < Number(min)) {
                //err.innerText = "Quantity must not be lower than minimum";
                //err.style.display = "block";
                openCritPopup();
                return;
            }
            infoOpenPopup('addForm');
        }
    }

    /*ADD QUANTITY ITEM CHECKFORM VALIDATION*/
    function checkForm_Add_Quan() {
        var bool = $('#qtyForm').valid();
        if (bool) {
            infoOpenPopup('qtyForm');
        }
    }

    /*ADD REPORT ITEM CHECKFORM VALIDATION*/
    function checkForm_Add_Quan() {
        var bool = $('#reportForm').valid();
        if (bool) {
            infoOpenPopup('reportForm');
        }
    }
    /*EDIT ITEM CHECKFORM VALIDATION*/
    function checkForm_Edit_Itm() {
        var bool = $('#editForm').valid();
        if (bool) {
            infoOpenPopup('editForm');
        }
    }
    // display quantity promopt
    function DisplayMessage(remarks, type) {
        if (remarks == "max") {
            if (type == "quant") {
                openExtraOverPopup();
            }
            if (type == "new") {
                openOverPopup();
            }
        }
        else if (remarks == "min") {
            if (type == "quant") {
                openAddOverPopup();
            }
        }

    }

    function SendItemCodes() {
        var container = document.getElementById("codeArea");
        var divs = container.querySelectorAll(".code-card label");
        var batchQuant = document.getElementById("batchQuant");
        var arr = [];
        divs.forEach((div) => {
            arr.push(div.innerHTML)
        });

        fetch("/Admin/BatchQuantity?quantity=" + batchQuant.value, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(arr)
        })
            .then(response => {
                if (response.ok) {
                    return response.json()
                }
                else {
                    throw new Error('Network response was not ok');
                }
            })
            .then(data => {
                let message = data;
                if (message.message == "okay") {
                    window.location.reload();
                }
                console.log('Response from server:', data);
            })
            .catch(error => {
                console.error('Error:', error);
            });

    }

    function validateBatchQuantity() {
        var container = document.getElementById("codeArea");
        var batchQuant = document.getElementById("batchQuant");
        var errMess = document.getElementById("batchQuant-error");
        var divs = container.querySelectorAll(".code-card label");
        var arr = [];
        var bool = false;

        if (divs.length == 0) {
            errMess.innerText = `Please Add an item codes`;
            errMess.style.display = "block";
            return;
        }

        divs.forEach((div) => {
            arr = findItem(div.innerHTML);
            let quant = extractNum(arr.in_quantity).num;
            let res = Number(quant) + Number(batchQuant.value);

            if (res > arr.Limits.maximum) {
                errMess.innerText = `Item Code : ${arr.in_code} has reached its maximum limit(${arr.Limits.maximum}) and will be Overstock`;
                errMess.style.display = "block";
                bool = false;
                return;
            }
            else if (res < arr.Limits.minimum) {
                errMess.innerText = `Item Code : ${arr.in_code} is below its minimum limit(${arr.Limits.minimum}) and will be Critical`;
                errMess.style.display = "block";
                bool = false;
                return;
            }
            else {
                errMess.innerText = ``;
                errMess.style.display = "none";
                bool = true;
                return;
            }
        });
        if (batchQuant.value.length == 0) {
            errMess.innerText = `Quantity field is required`;
            errMess.style.display = "block";
            return;
        }
        if (bool) {
            infoOpenPopup("batchQuant");
        }
    }

    function findItem(code) {
        for (let j = 0; j < fixedArray.length; j++) {
            if (fixedArray[j].in_code.toLowerCase() == code.toLowerCase()) {
                return fixedArray[j];
            }
        }
    }

    function validateQuantity(code, value, type) {
        let arr = findItem(code);

        var num = extractNum(arr.in_quantity).num;
        var result = Number(num) + Number(value);
        var bool = false;
        var message = "";
        if (result > arr.Limits.maximum) {
            message = "Quantity has exceeded the maximum amount";
            //DisplayMessage("max", type);
        }
        else if (result < arr.Limits.minimum) {
            message = "Quantity reached the minimum amount";
            //DisplayMessage("min", type);
        }
        else {
            bool = true;
        }
        return { bool, message };
    }

    function AddQuantity(code,val) {
        fetch('/Admin/AddQuantity?code=' + code + '&quantity=' + val, {
            method: "POST"
        })
            .then(res => {
                if (res.ok) {
                    // API request was successful
                    return;
                } else {
                    console.log(res.statusText);
                }
            })
            .then(data => {
                window.location.reload();
            })
            .catch(error => {
                console.error(error);
            });
    }

    document.getElementById("conf").addEventListener("click", function () {
        var code = localStorage.getItem("itemCode");
        var val = document.getElementById("quantVal").value;
        var result = validateQuantity(code, val, "quant");
        //console.log(result);
        if (!result.bool) {
            var err = document.getElementById("errMess");
            err.innerText = result.message;
            return;
        }
        AddQuantity(code, val);
    });

    let codeToDelete = "";
    //window.onload = function () {
    function OnLoad() {
        let removed = localStorage.getItem("removed");
        let mssg = '@Session["added"]';
        if (mssg != "") {
            saveOpenPopup();
            document.getElementById("updatemess").innerHTML = mssg;
            @{
                Session["added"] = "";
             }
        }
        if (removed == "success") {
            rempopup.classList.add("rem-popup-show");
            localStorage.setItem("removed", "pending");
        }
        GetAll();
    }

    // Close the dropdown if the user clicks outside of it
    window.onclick = function (e) {
        if (!e.target.matches('.drop-btn')) {
            var myDropdown = document.getElementById("myDropdown");
            if (myDropdown.classList.contains('show')) {
                myDropdown.classList.remove('show');

            }
        }
    }

    function userSortFunction() {
        document.getElementById("invSortDropdown").classList.toggle("inventory-sort-show");
    }

    let archpopup = document.getElementById("arch-popup");
    function OpenArchPopup() {
        archpopup.classList.add("arch-popup-show")
    }

    function CloseArchPopup() {
        archpopup.classList.remove("arch-popup-show")
    }

    // Close the dropdown if the user clicks outside of it
    window.onclick = function (e) {
        if (!e.target.matches('.inventory-sort-btn')) {
            var myDropdown = document.getElementById("invSortDropdown");
            if (myDropdown.classList.contains('inventory-sort-show')) {
                myDropdown.classList.remove('inventory-sort-show');
            }
        }
    }
    //Messege Box

    let extraoverpopup = document.getElementById("extra-over-popup");
    function openExtraOverPopup() {
        extraoverpopup.classList.add("over-popup-show");
        //var button = document.getElementById("qtyOverConf");
        //button.addEventListener("click", function () {
        //    checkForm_Edit_Itm();
        //});
    }

    function closeExtraOverPopup() {
        extraoverpopup.classList.remove("over-popup-show")
    }

    let addoverpopup = document.getElementById("add-over-popup");
    function openAddOverPopup() {
        addoverpopup.classList.add("over-popup-show")
    }

    function closeAddOverPopup() {
        addoverpopup.classList.remove("over-popup-show")
    }

    let overpopup = document.getElementById("over-popup");
    function openOverPopup() {
        overpopup.classList.add("over-popup-show")
    }

    function closeOverPopup() {
        overpopup.classList.remove("over-popup-show")
    }

    let critpopup = document.getElementById("crit-popup");
    function openCritPopup() {
        critpopup.classList.add("crit-popup-show")
    }

    function closeCritPopup() {
        critpopup.classList.remove("crit-popup-show")
    }
    //for edit ito celis naglagay try lang hahaha 
    let overpopup1 = document.getElementById("edit-over-popup");
    function openOverPopupEdit() {
        overpopup1.classList.add("over-popup-show")
    }

    function closeOverPopupEdit() {
        overpopup1.classList.remove("over-popup-show")
    }

    let critpopup1 = document.getElementById("edit-crit-popup");
    function openCritPopupEdit() {
        critpopup1.classList.add("crit-popup-show")
    }

    function closeCritPopupEdit() {
        critpopup1.classList.remove("crit-popup-show")
    }
    //end 
    let popup = document.getElementById("popup");
    function openPopup() {
        popup.classList.add("open-popup-show")
    }

    function closePopup() {
        popup.classList.remove("save-pop-container-show")
    }
    let infopopup = document.getElementById("info-popup");
    let saveForm = document.getElementById("saveForm");

    //function infoOpenPopup(formType) {
    //    infopopup.classList.add("info-popup-show")
    //    if (formType == "qtyForm") {
    //        var code = localStorage.getItem("itemCode");
    //        var val = document.getElementById("quantVal").value;
    //        saveForm.setAttribute("onclick", `AddQuantity("${code}", "${val}")`);
    //        return;
    //    }
    //    saveForm.setAttribute('form', formType);
    //}

    function infoOpenPopup(formType) {
        infopopup.classList.add("info-popup-show")
        //if (formType == "reportForm") {
        //    var code = localStorage.getItem("itemCode");
        //    var val = document.getElementById("quantVal").value;
        //    saveForm.setAttribute("onclick", `AddQuantity("${code}", "${val}")`);
        //    return;
        //}
        //if (formType == "batchQuant") {
        //    saveForm.setAttribute("onclick", `SendItemCodes()`);
        //    return;
        //}
        saveForm.setAttribute('form', formType);
    }

    function infoClosePopup() {
        infopopup.classList.remove("info-popup-show")
    }

    let qtypopupinv = document.getElementById("add-qty-popup-inv");
    function qtyOpenPopupInv() {
        qtypopupinv.classList.add("add-qty-popup-inv-show")
    }
    function qtyClosePopupInv() {
        qtypopupinv.classList.remove("add-qty-popup-inv-show")
    }

    @* ADD REPORT *@

    let reportpopupinv = document.getElementById("add-report-popup-inv");
    function reportOpenPopupInv() {
        reportpopupinv.classList.add("add-report-popup-inv-show")
    }
    function reportClosePopupInv() {
        reportpopupinv.classList.remove("add-report-popup-inv-show")
    }

    let editpopupinv = document.getElementById("edit-item-popup-inv");
    function editOpenPopupInv() {
        editpopupinv.classList.add("edit-item-popup-inv-show")
    }
    function editClosePopupInv() {
        editpopupinv.classList.remove("edit-item-popup-inv-show")
    }

    let addpopupinv = document.getElementById("add-popup-inv");
    function addOpenPopupInv(formType) {
        addpopupinv.classList.add("add-popup-inv-show")
        //saveForm.setAttribute('form', formType);
    }
    function addClosePopupInv() {
        addpopupinv.classList.remove("add-popup-inv-show");
    }

    let delpopup = document.getElementById("del-popup");
    function delOpenPopup(value) {
        delpopup.classList.add("del-popup-show");
        localStorage.setItem("code", value);
    }
    function delClosePopup() {
        delpopup.classList.remove("del-popup-show");
    }

    let savepopup = document.getElementById("save-popup");
    function saveOpenPopup() {
        savepopup.classList.add("save-pop-show");
    }

    function saveClosePopup() {
        savepopup.classList.remove("save-pop-container")
    }

    let canpopup = document.getElementById("can-popup");
    function canOpenPopup() {
        canpopup.classList.add("can-popup-show");
        $('#addForm').validate().resetForm();
        $('#qtyForm').validate().resetForm
        $('#reportForm').validate().resetForm();
        $('#editForm').validate().resetForm();

    }

    function canClosePopup() {
        canpopup.classList.remove("can-popup-show")
    }

    let rempopup = document.getElementById("rem-popup");

    function remOpenPopup() {
        rempopup.classList.add("rem-popup-show")
    }

    function remClosePopup() {
        rempopup.classList.remove("rem-popup-show")
    }

    let printpopup = document.getElementById("print-popup");

    function printOpenPopup() {
        printpopup.classList.add("print-popup-show")
    }

    function printClosePopup() {
        printpopup.classList.remove("print-popup-show")
    }

    let expopopup = document.getElementById("expo-popup");

    function expoOpenPopup() {
        expopopup.classList.add("expo-popup-show")
    }

    function expoClosePopup() {
        expopopup.classList.remove("expo-popup-show")
    }

    function openInvInputQTYForm(val) {
        document.getElementById("inv-input-popup").style.display = "block";
        localStorage.setItem("itemCode", val);
    }

    function closeInvInputQTYForm() {
        var val = document.getElementById("quantVal").value;
        var err = document.getElementById("errMess");
        val = "";
        err.innerText = "";
        document.getElementById("inv-input-popup").style.display = "none";
    }

    //HISTORY POPUP
    function openHisForm() {
        document.getElementById("his-container").style.display = "block";
    }

    function closeHisForm() {
        document.getElementById("his-container").style.display = "none";
    }

</script>