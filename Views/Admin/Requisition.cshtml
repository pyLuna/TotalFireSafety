
@{
    ViewBag.Title = "Requisition";
    Layout = "~/Views/AdminLayout.cshtml";
    ViewBag.Req = "active";
}

<div class="main-content">
    <header>
        <h2>
            <label for="nav-toggle">
                <span class="las la-bars"></span>
            </label>
            Requisition
        </h2>
                <right>
                    <button class="create-req-btn" title="CREATE ORDER">
                        <a onclick="openForm()">
                            Notification
                            <span class="las la-bell"></span>
                            <label class="notif-badge" id="badge">0</label>
                        </a>
                    </button>
                </right>
        </header>

    <div class="purchase-buttons-style">

        <!-- NOTIFICATION CONTAINER -->

        <div class="notif-popup" id="notifForm">

            <div class="notif-header">
                <button type="button" class="close-btn" onclick="closeForm()"><i class="las la-times-circle"></i></button>
                <h3>Notification</h3>
            </div>

            <div class="notif-container" id="ntfCont">

                @*

                *@


                    @*<div class="notif-list-container-active">
                <label>
                    There’s a new submitted Deployment Request with RequestID: DEPREQ12.
                </label>
                <a onclick="viewOpenForm() + closeForm()">View Details <span class="las la-long-arrow-alt-right"></span> </a>

            </div>

            <div class="notif-list-container">
                <label>
                    There’s a new submitted Deployment Request with RequestID: DEPREQ12.
                </label>
                <a onclick="viewOpenForm() + closeForm()">View Details <span class="las la-long-arrow-alt-right"></span> </a>

            </div>

            <div class="notif-list-container">
                <label>
                    There’s a new submitted Deployment Request with RequestID: DEPREQ12.
                </label>
                <a onclick="viewOpenForm() + closeForm()">View Details <span class="las la-long-arrow-alt-right"></span> </a>

            </div>

            <div class="notif-list-container">
                <label>
                    There’s a new submitted Deployment Request with RequestID: DEPREQ12.
                </label>
                <a onclick="viewOpenForm() + closeForm()">View Details <span class="las la-long-arrow-alt-right"></span> </a>

            </div>
            <div class="notif-list-container">
                <label>
                    There’s a new submitted Deployment Request with RequestID: DEPREQ12.
                </label>
                <a onclick="viewOpenForm() + closeForm()">View Details <span class="las la-long-arrow-alt-right"></span> </a>

            </div>
            <div class="notif-list-container">
                <label>
                    There’s a new submitted Deployment Request with RequestID: DEPREQ12.
                </label>
                <a onclick="viewOpenForm() + closeForm()">View Details <span class="las la-long-arrow-alt-right"></span> </a>

            </div>
            <div class="notif-list-container">
                <label>
                    There’s a new submitted Deployment Request with RequestID: DEPREQ12.
                </label>
                <a onclick="viewOpenForm() + closeForm()">View Details <span class="las la-long-arrow-alt-right"></span> </a>

            </div>*@

                </div>
            </div>

        <!-- END -->
        <!-- VEW NOTIFICATION CONTAINER -->

        <div class="view-popup" id="viewForm">
            <div class="view-container">

                <a onclick="openForm() + viewCloseForm()"><span class="las la-long-arrow-alt-left"></span> Back </a>

                <div class="view-list-container">
                    <center>
                        <label>
                            <h3>RequestID: DEPREQ12</h3>
                        </label>
                    </center>

                </div>

                <div class="acc-container">

                </div>
            </div>
            <center>
                <button type="button" class="appr-btn" onclick="">
                    <a>
                        Approve
                        <span class="las la-check-circle"></span>
                    </a>
                </button>

                <button type="button" class="appr-btn" onclick="">
                    <a>
                        Decline
                        <span class="las la-times-circle"></span>
                    </a>
                </button>

            </center>
        </div>

        <!-- END -->

    </div>

    <main>
        <br>

        <div class="upper-section">
            <div class="search-wrapper">
                <span class="las la-search"></span>
                <input type="text" placeholder="Search here" onkeyup="SearchItem(this.value)">
            </div>

            &nbsp;

            <div class="drp-wrapper">
                <select id="selcat" onchange="SortByCategory(this,this.value)">
                    <option disabled selected>Request Type</option>
                    <option value="Purchase">Purchasing</option>
                    <option value="Supply">Supply</option>
                    <option value="Deploy">Deployment</option>
                    <option value="">All</option>
                </select>
            </div>
        </div>
        </br>
        </br>
        <div class="purchase-grid">
            <div class="purchase-header">
                <h3>REQUEST LISTS</h3>
                <div class="purchase-buttons-style">
                    <!--NEW UPDATE -->
                    @if (Int32.Parse(Session["system_role"].ToString()) != 1)
                    {
                        <button class="create-req-btn" title="CREATE ORDER" onclick="createrequestOpenPopupPur() + SetLabels() + HideApprovedItems()">
                            <a id="autoClickLink" onclick="createrequestOpenPopupPur() + SetLabels()">
                                CREATE REQUEST
                                <span class="las la-file-alt"></span>
                            </a>
                        </button>
                    }
                    <script>
                        window.addEventListener("message", function (event) {
                            if (event.data === "autoClickLink") {
                                var autoClickLink = document.getElementById("autoClickLink");
                                if (autoClickLink) {
                                    autoClickLink.click(); // trigger the click event on the target link
                                }
                            }
                        });

                       
                    </script>
                   
                    @*<select id="filter" onchange="SortByCategory(this,this.value)">
            <option disabled selected>FILTER</option>
            <option>All</option>
            <option>Local</option>
            <option>Import</option>
        </select>*@

                </div>

            </div>

            <div class="purchase-projects">
                <div class="purchase">
                    <div class="purchase-body">
                        <div class="table-responsive" style="overflow-x: auto;">
                            <table width="100%" id="myTable">
                                <thead>
                                    <tr>
                                        <td onclick="Sort(this,'Id')"><a>Request ID<i class="las la-sort-down"></td>
                                        <td onclick="Sort(this,'request_type')"><a>Type<i class="las la-sort-down"></td>
                                        <td>Name</td>
                                        <td>Employee ID</td>
                                        <td>Date Requested</td>
                                        <td>Status</td>
                                        <td>Action</td>
                                    </tr>
                                </thead>
                                <tbody>
                                    @*<tr onclick="viewrequestOpenPopupPur()">
                                    <td class="view"> <a onclick="viewrequestOpenPopupPur()"> PREQ67490 </a></td>
                                    <td>Clarisse C. Vasques</td>
                                    <td>008273126</td>
                                    <td>Jan. 11, 2023</td>
                                    <td>Supply Request</td>
                                    <td><label class="stat-dec">Declined</label></td>
                                    <td>
                                        <div class="purchase-action-style">
                                            <button class="acc-btn" title="ACCEPT REQUEST" onclick="infoOpenPopup()"> <a href="#"><span class="las la-check-circle"></span></a></button>
                                            <button class="dec-btn" title="DECLINE REQUEST" onclick="openRemarksForm()"> <a href="#"><span class="las la-times-circle"></span></a></button>
                                            <button class="pri-btn" title="PRINT" onclick=""> <a href="#"><span class="las la-print"></span></a></button>
                                            <button class="del-btn" title="DELETE" onclick=""> <a href="#"><span class="las la-trash-alt"></span></a></button>
                                        </div>
                                    </td>
                                </tr>*@
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="view-request-popup-pur" id="view-request-popup-pur">
                <div class="view-request-container">
                    <div class="view-request-form-container" id="cont">
                        <form action="">

                            <div class="view-request-details">
                                <div class="view-request-form-header">
                                    REQUEST DETAILS
                                </div>
                                <div class="view-request-form-contents">
                                    <div class="fields">
                                        <div class="input-field">
                                            <label><a>Request ID: </a></label>
                                            <label id="edit-reqId"></label>
                                        </div>

                                        <div class="input-field">
                                            <label><a>Name: </a></label>
                                            <label id="edit-reqName"></label>
                                        </div>
                                        <div class="input-field">
                                            <label><a>Request Type: </a></label>
                                            <label id="edit-reqType"></label>
                                        </div>
                                        <div class="input-field">
                                            <label><a>Date Requested: </a></label>
                                            <label id="edit-reqDate"></label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            @*  COLOR CLASS FOR STATUS
                        .view-request-form-table table td .stat-approved {
                            color: #09AF10;
                        }

                        .view-request-form-table table td .stat-active {
                            color: #FF932F;
                        }
                            *@

                            <div class="view-request-details">
                                <div class="view-request-form-header">
                                    REQUESTED ITEMS
                                </div>
                                <div class="view-request-form-contents">
                                    <div class="view-request-form-table">
                                        <div class="view-request-form-table-style">
                                            <div class="table-responsive" style="overflow-x: auto;">
                                                <table width="100%" id="reqDetails">
                                                    <thead>
                                                        <tr>
                                                            <td class="checkbox-view edit-td"></td>
                                                            <td>Name</td>
                                                            <td>Category</td>
                                                            <td>Type</td>
                                                            <td>Size</td>
                                                            <td>Quantity</td>
                                                            <td>Request Quantity</td>
                                                            <td>Status</td>
                                                            <td style="display:none" id="actCol">Action</td>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        @*<tr>
                                                        <td><input type="checkbox"></td>
                                                        <td><label>ball wave</label></td>
                                                        <td><label>others</label></td>
                                                        <td><label>hfc</label></td>
                                                        <td><label>n/a</label></td>
                                                        <td><label>n/a</label></td>
                                                        <td><label class="stat-crit">critical</label></td>
                                                        <td>
                                                        </td>
                                                    </tr>*@

                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <br>
                            <br>

                            <div class="view-request-details">
                                <div class="view-request-form-header">
                                    APPROVED ITEMS
                                </div>
                                <div class="view-request-form-contents">
                                    <div class="view-request-form-table">
                                        <div class="view-request-form-table-style">
                                            <div class="table-responsive" style="overflow-x: auto;">
                                                <table width="100%" id="apprItems">
                                                    <thead>
                                                        <tr>
                                                            <td class="checkbox-view edit-td"></td>
                                                            <td>Name</td>
                                                            <td>Category</td>
                                                            <td>Type</td>
                                                            <td>Size</td>
                                                            <td>Quantity</td>
                                                            <td>Request Quantity</td>
                                                            <td>Status</td>
                                                            <td style="display:none" id="actCol1">Action</td>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        @*<tr>
                                                        <td></td>
                                                        <td><label>Gate Valve Flange Type</label></td>
                                                        <td><label>Gate Valve</label></td>
                                                        <td><label></label></td>
                                                        <td><label></label></td>
                                                        <td><label>Null</label></td>
                                                        <td><input type="number"></td>
                                                        <td><label class="stat-crit">Critical</label></td>
                                                        <td>
                                                            <div class="view-action-style">
                                                                <a>delete</a>
                                                            </div>
                                                        </td>
                                                    </tr>*@

                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>


                        </form>
                        <center>
                            <div class="form-add-btns checkbox-view edit-td" id="frmBtn">
                                <button class="save" id="saveBtn">
                                    <span class="btnText">Confirm</span>
                                    <i class="las la-check-square"></i>
                                </button>

                                <button class="cancel">
                                    <span class="btnText" onclick="canOpenPopup()">Cancel</span>
                                    <i class="las la-window-close"></i>
                                </button>
                            </div>
                            <button class="cancel" id="closeBtn">
                                <span class="btnText" onclick="viewrequestClosePopupPur()">Close</span>
                                <i class="las la-window-close"></i>
                            </button>
                        </center>
                    </div>
                </div>
            </div>

            <!-- END -->
            <!-- CREATE REQUEST -->

            <div class="create-request-popup-pur" id="create-request-popup-pur">
                <div class="create-request-container">
                    <div class="create-request-form-container">
                        <form action="" id="create-form">

                            <div class="create-request-details">
                                <div class="create-request-form-header">
                                    REQUEST DETAILS
                                </div>
                                <div class="create-request-form-contents">
                                    <div class="fields" id="create-fields">
                                        <div class="input-field">
                                            <label><a>Request ID: </a></label>
                                            <label id="reqId"></label>
                                        </div>

                                        <div class="input-field">
                                            <label><a>Name: </a></label>
                                            <label id="reqName"></label>
                                        </div>
                                        <div class="input-field">
                                            <label><a>Request Type: </a></label>
                                            <label id="reqType"></label>
                                        </div>
                                        <div class="input-field">
                                            <label><a>Date Requested: </a></label>
                                            <label id="reqDate"></label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </br>
                            </br>
                            <div class="create-request-details">
                                <div class="create-request-form-header">
                                    ITEM DETAILS
                                    <div class="add-item">
                                        <button class="create-req-btn" title="CREATE ORDER">
                                            <a onclick="itemlistOpenPopupPur()" id="add-item">
                                                ADD ITEM
                                                <span class="las la-file-alt"></span>
                                            </a>
                                        </button>
                                    </div>
                                </div>

                                <div class="create-request-form-contents">
                                    <div class="create-request-form-table">
                                        <div class="create-request-form-table-style">
                                            <div class="table-responsive" style="overflow-x: auto;">
                                                <table width="100%" id="create-table">
                                                    <thead>
                                                        <tr>
                                                            <td>Name</td>
                                                            <td>Category</td>
                                                            <td>Type</td>
                                                            <td>Size</td>
                                                            <td>Remarks</td>
                                                            <td>Request Quantity</td>
                                                            <td>Action</td>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        @*<tr>
                                                        <td><input type="checkbox"></td>
                                                        <td><label>HXX-ASJ-0000</label></td>
                                                        <td><label>Gate Valve Flange Type</label></td>
                                                        <td><label>Gate Valve</label></td>
                                                        <td><label></label></td>
                                                        <td><label></label></td>
                                                        <td><label>Null</label></td>
                                                        <td><label>Imported</label></td>
                                                        <td><label class="stat-crit">Critical</label></td>
                                                        <td>
                                                            <div class="create-action-style">
                                                                <a>delete</a>
                                                            </div>
                                                        </td>
                                                    </tr>*@

                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </form>
                        </br>
                        </br>
                        </br>
                        <center>
                            <div class="form-add-btns">
                                <button class="save" onclick="infoOpenPopup()">
                                    <span class="btnText" id="cnfBtn">Confirm</span>
                                    <i class="las la-check-square"></i>
                                </button>

                                <button class="cancel">
                                    <span class="btnText" onclick="canOpenPopup()">Cancel</span>
                                    <i class="las la-window-close"></i>
                                </button>
                            </div>
                        </center>
                    </div>
                </div>
            </div>

            <!-- END -->
            <!-- ADD INVENTORY LIST -->

            <div class="itemlist-popup-pur" id="itemlist-popup-pur">
                <div class="itemlist-container">
                    <div class="itemlist-form-container">
                        <form action="">
                            <div class="itemlist-details">
                                <div class="itemlist-form-header">
                                    ITEM LISTS
                                    <right>
                                        <div class="item-section">
                                            <div class="item-wrapper">
                                                <span class="las la-search"></span>
                                                <input type="text" placeholder="Search here" onkeyup="SearchItem1(this.value)">
                                            </div>
                                        </div>
                                    </right>
                                </div>
                                <div class="itemlist-form-contents">
                                    <div class="itemlist-form-table">
                                        <div class="itemlist-form-table-style">
                                            <div class="table-responsive" style="overflow-x: auto;">
                                                <table width="100%" id="InvTable">
                                                    <thead>
                                                        <tr>
                                                            <td><a>Name<i class="las la-sort-down"></i></a></td>
                                                            <td>Category</td>
                                                            <td>Type</td>
                                                            <td>Size</td>
                                                            <td>Remarks</td>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        @*<tr onclick="openInputQTYForm()">

                                                        <td><label>Clarisse C. Vaquez</label></td>
                                                        <td><label>Supervisor</label></td>
                                                        <td><label>0923758923</label></td>
                                                        <td><label>12341241</label></td>
                                                        <td><label class="stat-standard">Standard</label></td>
                                                    </tr>*@

                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <br>
                            <br>

                        </form>
                        <center>
                            <div class="form-add-btns">
                                <button class="cancel">
                                    <span class="btnText" onclick="itemlistClosePopupPur()">Back</span>
                                    <i class="las la-window-close"></i>
                                </button>
                            </div>
                        </center>
                    </div>
                </div>
            </div>

            <!-- END -->
            <!-- INPUT POPUP -->

            <div class="input-popup" id="input-popup">
                <h3>INPUT QUANTITY</h3>
                    <input type="number" id="quantVal" name="quantVal" required>
                    <input type="text" id="hiddenCode" style="display:none;">
                    <br />
                    <p class="emErr" style="margin-top: 5px; color: red;"></p>
                    <br>
                    <br>
                    <button id="conf">confirm</button>
                    <button onclick="closeInputQTYForm()">cancel</button>
            </div>

            <div class="input-popup1" id="input-popup1">
                <h3>INPUT QUANTITY</h3>
                <input type="number" id="quantVal1">
                @*<input type="text" id="hiddenCode1" style="display:none;">*@

                <br>
                <br>
                <button id="conf1">confirm</button>
                <button onclick="closeInputQTYForm1()">cancel</button>
            </div>

            <!-- END -->

            <!-- REMARKS BOX -->

            <div class="remarks-popup" id="remarks-popup">               

                <div class="remarks-header">
                    <center>
                        <h3>ADD REMARKS</h3>
                    </center>                    
                </div>

                <div class="remarks-container">
                    <textarea name="" id="" cols="30" rows="10"></textarea>
                </div>
                <center>
                    <button type="button" class="appr-btn" onclick="">
                        <a>
                            SAVE
                        </a>
                    </button>

                    <button type="button" class="appr-btn" onclick="">
                        <a>
                            CANCEL
                        </a>
                    </button>
                </center>
            </div>

            <!-- END -->

            <div class="can-pop-container" id="can-popup1">
                <img src="@Url.Content("~/images/warning.png")">
                <h2>System Warning!</h2>
                <p>Do you want to go back?</p>
                <button type="button" onclick="">Yes</button>
                <button type="button" onclick="canClosePopup()">Cancel</button>
            </div>

            <input type="text" id="formType" style="display:none">
            <div class="info-pop-container" id="info-popup">
                <img src="@Url.Content("~/images/information.png")">
                <h2>System Warning!</h2>
                <p>Do you want to save employee's request?</p>
                <button type="button" onclick="saveRequest()">Yes</button>
                <button type="button" onclick="infoClosePopup()">Cancel</button>
            </div>

            <div class="save-pop-container" id="popup">
                <img src="@Url.Content("~/images/tick.png")">
                <h2>Accepted!</h2>
                <p>@ViewBag.Message</p>
                <button type="button" onclick="closePopup()">OK</button>
            </div>

            <div class="can-pop-container" id="can-popup">
                <img src="@Url.Content("~/images/warning.png")">
                <h2>System Warning!</h2>
                <p>Do you want to cancel any changes?</p>
                <button type="button" onclick="remOpenPopup() + viewrequestClosePopupPur() + itemlistClosePopupPur() + createrequestClosePopupPur() + canClosePopup() + addClosePopupPur() + resetForm()">Yes</button>
                <button type="button" onclick="canClosePopup()">Cancel</button>
            </div>

            <div class="rem-pop-container" id="rem-popup">
                <img src="@Url.Content("~/images/remove.png")">
                <h2>Deleted!</h2>
                <p>Request Discarded!</p>
                <button type="button" onclick="remClosePopup()">OK</button>
            </div>

            <div class="print-pop-container" id="print-popup">
                <img src="@Url.Content("~/images/printer.png")">
                <h2>Print!</h2>
                <p>Print successfully!</p>
                <button type="button" onclick="printClosePopup()">OK</button>
            </div>

            <div class="expo-pop-container" id="expo-popup">
                <img src="@Url.Content("~/images/export.png")">
                <h2>Export!</h2>
                <p>Exported Successfully!</p>
                <button type="button" onclick="expoClosePopup()">OK</button>
            </div>

</main>
</div>
<script src='@Url.Content("~/Scripts/validations/RequisitionValidation.js")'></script>
<script src="@Url.Content("~/Scripts/Requisition.js")"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>

<script>
    window.onload = function () {
        var projectId = getUrlParameter("projectId");
        document.getElementById("rep_proj_id").value = projectId;
        // Use the projectId value as needed
    };

    function getUrlParameter(name) {
        name = name.replace(/[[]/, '\\[').replace(/[\]]/, '\\]');
        var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
        var results = regex.exec(location.search);
        return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
    }
</script>

<script>
    //function submitForm() {
    //    form.submit();
    //}

    //function checkForm() {
    //    var bool = $('#input_quan_form').valid();
    //    if (bool) {
    //        alert("nag validate!");
    //    }
    //}
    //function Validate() {
    //    var QuantVal = $("#quantVal").val();

    //    if (QuantVal == "") {
    //        $(".emErr").html("Quantity is required.");
    //    }
    //    else {
    //        closeInputQTYForm1()
    //    }
    //}

    function exportToPdf() {
        const actionButtons = document.querySelectorAll('.purchase-action-style');
        actionButtons.forEach(button => button.style.display = 'none');


        const element = document.querySelector('#myTable');
        const options = {
            margin: [0, 0, 0, 0],
            filename: 'invoice.pdf',
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 2 },
            jsPDF: { unit: 'in', format: 'letter', orientation: 'landscape' },
            // Add header option
            header: {
                height: '1cm',
                contents: '<div id="header"><img id="logo" src="~/images/LogoNameFull.png"></div>',
                onBeforeParse: (pdf, doc, pages, callback) => {
                    const header = document.getElementById('header');
                    const logo = document.getElementById('logo');
                    callback(header);
                }
            }
        };
        html2pdf()
            .set(options)
            .from(element)
            .save()
            .then(() => {
                // Show action buttons again after exporting
                actionButtons.forEach(button => button.style.display = 'block');
            });
    }

</script>
<script>

    //window.onload = function () {
    function OnLoad() {
        GetAll();
        GetAllEmployee();
        GetAllItem();
        localStorage.setItem('increment', null);
        let success = localStorage.getItem("success");
        if (success != 'undefined' && success !== '' && success !== null) {
            openPopup(success);
            localStorage.setItem("success", "");
        }
    }

    function userSortFunction() {
        document.getElementById("purSortDropdown").classList.toggle("purchase-sort-show");
    }

    // Close the dropdown if the user clicks outside of it
    window.onclick = function (e) {
        if (!e.target.matches('.purchase-sort-btn')) {
            var myDropdown = document.getElementById("purSortDropdown");
            if (myDropdown.classList.contains('purchase-sort-show')) {
                myDropdown.classList.remove('purchase-sort-show');
            }
        }
    }

    //WAREHOUSE VIEW REQUEST
    let viewrequest = document.getElementById("view-request-popup-pur");
    let approveddetails = document.getElementById("view-request-details");
    function HideApprovedItems() {
        approveddetails.style.display = "none";
    }
    function viewrequestOpenPopupPur(reqId,type) {
        viewrequest.classList.add("view-request-popup-pur-show");
        DisplayDataOnRow(reqId,type);
    }

    function viewrequestClosePopupPur() {
        viewrequest.classList.remove("view-request-popup-pur-show")
    }

    let createrequest = document.getElementById("create-request-popup-pur");
    function createrequestOpenPopupPur() {
        createrequest.classList.add("create-request-popup-pur-show")
    }

    function createrequestClosePopupPur() {
        createrequest.classList.remove("create-request-popup-pur-show")
    }

    let addpopupinv = document.getElementById("add-popup-inv");
    function addOpenPopupInv() {
        addpopupinv.classList.add("add-popup-inv-show")
    }

    function addClosePopupInv() {
        addpopupinv.classList.remove("add-popup-inv-show")
    }

    let itemlist = document.getElementById("itemlist-popup-pur");
    function itemlistOpenPopupPur() {
        itemlist.classList.add("itemlist-popup-pur-show")
    }

    function itemlistClosePopupPur() {
        itemlist.classList.remove("itemlist-popup-pur-show")
    }

    // SCRIPT FOR NOTIFICATION

    function openForm() {
        document.getElementById("notifForm").style.display = "block";
    }

    function closeForm() {
        document.getElementById("notifForm").style.display = "none";
    }

    function viewOpenForm() {
        document.getElementById("viewForm").style.display = "block";
    }

    function viewCloseForm() {
        document.getElementById("viewForm").style.display = "none";
    }

    function openRemarksForm() {
        document.getElementById("remarks-popup").style.display = "block";
    }

    function closeRemarksForm() {
        document.getElementById("remarks-popup").style.display = "none";
    }

    function openInputQTYForm(itemCode) {
        document.getElementById("input-popup").style.display = "block";
        document.getElementById('hiddenCode').value = itemCode;
    }
    document.getElementById('conf').addEventListener("click", function () {
        var quant = document.getElementById('quantVal').value;
        var code = document.getElementById('hiddenCode').value;
        if (quant === '' || quant === null || isNaN(quant)) {
            $(".emErr").html("Please input quantity.");
        }
        else if (quant > 200) {
            $(".emErr").html("Quantity must not exceed 200");
        }
        else {
            DataToAdd(quant, code);
            closeInputQTYForm();
            document.getElementById('quantVal').value = '';
        }
            
    });
    function closeInputQTYForm() {
        document.getElementById("input-popup").style.display = "none";
        $(".emErr").html("");
    }
    let row = "";
    function openInputQTYForm1(rows) {
        document.getElementById("input-popup1").style.display = "block";
        //document.getElementById('hiddenCode').value = itemCode;
        row = rows;
    }
    var quant = document.getElementById('quantVal1');

    quant.addEventListener("keypress", function (event) {
        if (event.key === "Enter") {
            editRow();
        }
    });

    const element = document.getElementById('conf1');
    element.addEventListener("click", function () {
        editRow();
    });

    function editRow() {
        var unit = extractNum(row.cells[6].innerHTML).measurement;
        row.cells[6].innerHTML = quant.value + " " + unit;
        closeInputQTYForm1();
        document.getElementById('quantVal1').value = '';
    }

    function closeInputQTYForm1() {
        document.getElementById("input-popup1").style.display = "none";
    }

    let addpopuppur = document.getElementById("add-popup-pur");
    function addOpenPopupPur() {
        addpopuppur.classList.add("add-popup-pur-show")
        document.getElementById("formType").value = "add";
    }

    function addClosePopupPur() {
        addpopuppur.classList.remove("add-popup-pur-show")
    }

    let infopopup = document.getElementById("info-popup");
    function infoOpenPopup() {
        infopopup.classList.add("info-popup-show")
    }

    function infoClosePopup() {
        infopopup.classList.remove("info-popup-show")
    }

    let popup = document.getElementById("popup");

    function openPopup(message) {
        var p = document.querySelector('#popup p');
        p.innerHTML = message;
        popup.classList.add("save-pop-show")
    }

    function closePopup() {
        popup.classList.remove("save-pop-show")
    }

    let canpopup = document.getElementById("can-popup");

    function canOpenPopup() {
        canpopup.classList.add("can-popup-show")
    }

    function canClosePopup() {
        canpopup.classList.remove("can-popup-show")
    }

    let rempopup = document.getElementById("rem-popup");

    function remOpenPopup() {
        rempopup.classList.add("rem-popup-show")
    }

    function remClosePopup() {
        const projectId = getUrlParameter('projectId');
        if (projectId !== '') {
            window.close(); // Close the window if projectId is not empty
        } else {
            rempopup.classList.remove('rem-popup-show');
        }
    }

    let printpopup = document.getElementById("print-popup");

    function printOpenPopup() {
        printpopup.classList.add("print-popup-show")
    }

    function printClosePopup() {
        printpopup.classList.remove("print-popup-show")
    }

    let expopopup = document.getElementById("expo-popup");

    function expoOpenPopup() {
        expopopup.classList.add("expo-popup-show")
    }

    function expoClosePopup() {
        expopopup.classList.remove("expo-popup-show")
    }
</script>

