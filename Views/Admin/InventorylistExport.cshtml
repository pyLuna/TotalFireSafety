@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>TFSTI - Deployment Request</title>
    <link rel="stylesheet" href="~/css/sa-inventory-style.css">
    <link rel="shortcut icon" type="image/icon" href="~/images/tfsti-logo-noname.png" />
    <link rel="stylesheet"
          href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css">
    <link rel="stylesheet" href="~/css/sa-dashboard-style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
            integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>
</head>

<body>
    <div style="padding: 0; margin-top: -50px;">
        <main>
            <center>
                <div @*class="TestContainer" *@>
                    <div @*class="Change_Table" *@>
                        <div class="container">
                            <div class="d-flex justify-content-between">
                                <img src="~/images/tfsti-logo-inventory.png" style="width: 35%; height: 150px;">
                                <div class="mt-3">
                                    <table cellspacing="0" cellpadding="0">
                                        <tr>
                                            <td colspan="2">Name: Carlo Millonte</td>
                                            <td colspan="2">Position: Office Admin</td>
                                        </tr>
                                        <tr>
                                            <td colspan="2">Employee ID: 101567890</td>
                                            <td colspan="2">Date Printed: March 13, 2023</td>
                                        </tr>
                                        <td colspan="2">List: 1-20</td>
                                        <td colspan="2"></td>
                                    </table>
                                </div>
                            </div>
                            <br><br>
                            <table id="myTable">
                                <tr>
                                    <td colspan="12" class="font-weight-bold text-center">INVENTORY STOCK REPORT</td>
                                </tr>

                                <tr style="background-color: rgb(255, 255, 0);" class="font-weight-bold">
                                    <td class="font-weight-bold">Date Added <span></span></td>
                                    <td class="font-weight-bold">Code</td>
                                    <td class="font-weight-bold">Name</td>
                                    <td class="font-weight-bold">Category</td>
                                    <td class="font-weight-bold">Type</td>
                                    <td class="font-weight-bold">Size</td>
                                    <td class="font-weight-bold">Quantity</td>
                                    <td class="font-weight-bold">Remarks</td>
                                    <td class="font-weight-bold">Class</td>
                                </tr>
                                @*
                                <tr>
                                    <td>March 1, 2023</td>
                                    <td>IMP-ANGLV-ANGLV</td>
                                    <td>Angela Valve</td>
                                    <td>Other</td>
                                    <td>Null</td>
                                    <td>1.5 IN</td>
                                    <td>150 PCS</td>
                                    <td>Standard</td>
                                    <td>Imported</td>
                                </tr>
                                <tr>
                                    <td>March 1, 2023</td>
                                    <td>IMP-ANGLV-ANGLV</td>
                                    <td>Angela Valve</td>
                                    <td>Other</td>
                                    <td>Null</td>
                                    <td>1.5 IN</td>
                                    <td>150 PCS</td>
                                    <td>Standard</td>
                                    <td>Imported</td>
                                </tr>
                                <tr>
                                    <td>March 1, 2023</td>
                                    <td>IMP-ANGLV-ANGLV</td>
                                    <td>Angela Valve</td>
                                    <td>Other</td>
                                    <td>Null</td>
                                    <td>1.5 IN</td>
                                    <td>150 PCS</td>
                                    <td>Standard</td>
                                    <td>Imported</td>
                                </tr>
                                <tr>
                                    <td>March 1, 2023</td>
                                    <td>IMP-ANGLV-ANGLV</td>
                                    <td>Angela Valve</td>
                                    <td>Other</td>
                                    <td>Null</td>
                                    <td>1.5 IN</td>
                                    <td>150 PCS</td>
                                    <td>Standard</td>
                                    <td>Imported</td>
                                </tr>
                                <tr>
                                    <td>March 1, 2023</td>
                                    <td>IMP-ANGLV-ANGLV</td>
                                    <td>Angela Valve</td>
                                    <td>Other</td>
                                    <td>Null</td>
                                    <td>1.5 IN</td>
                                    <td>150 PCS</td>
                                    <td>Standard</td>
                                    <td>Imported</td>
                                </tr>
                                <tr>
                                    <td>March 1, 2023</td>
                                    <td>IMP-ANGLV-ANGLV</td>
                                    <td>Angela Valve</td>
                                    <td>Other</td>
                                    <td>Null</td>
                                    <td>1.5 IN</td>
                                    <td>150 PCS</td>
                                    <td>Standard</td>
                                    <td>Imported</td>
                                </tr>
                                <tr>
                                    <td>March 1, 2023</td>
                                    <td>IMP-ANGLV-ANGLV</td>
                                    <td>Angela Valve</td>
                                    <td>Other</td>
                                    <td>Null</td>
                                    <td>1.5 IN</td>
                                    <td>150 PCS</td>
                                    <td>Standard</td>
                                    <td>Imported</td>
                                </tr>*@
                            </table>
                        </div>
                    </div>
                    <br>
                    <div class="mt-5 d-flex justify-content-end mr-3">
                        <div class="d-flex justify-content-between">
                            <button type="button" class="btn btn-primary btn-lg buttons1 ml-2" onclick="exportToPdf()">EXPORT</button>
                            @*<button type="button" class="btn btn-primary btn-lg buttons1 ml-2">PRINT</button>*@
                            <button type="button" class="btn btn-outline-primary buttons2 ml-2">CANCEL</button>
                        </div>
                    </div>
                    <!-- <script>
                        let d = new Date();
                        document.getElementById("demo").innerHTML = d.toDateString();
                    </script> -->
            </center>
        </main>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.16/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    <script>
        let arr = [];
        window.onload = function () {
            arr = JSON.parse(localStorage.getItem('allItems'));
            console.log(arr);
            setTable(arr);
        }

        function setTable(array) {
            var table = document.querySelector('#myTable');
            array.forEach((item) => {
                let row = `<tr>`;
                row += `<td>${item.in_dateAdded}</td>`;
                row += `<td>${item.in_code}</td>`;
                row += `<td>${item.in_name}</td>`;
                row += `<td>${item.in_category}</td>`;
                row += `<td>${item.in_type}</td>`;
                row += `<td>${item.in_size}</td>`;
                row += `<td>${item.in_quantity}</td>`;
                row += `<td>${item.in_remarks}</td>`;
                row += `<td>${item.in_class}</td>`;
                row += `</tr>`;
                table.innerHTML += row;
            });
        }

        function exportToPdf() {
            let element = document.querySelector('.container');
            let options = {
                margin: [0, 0, 0, 0],
                filename: 'Report.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: getScaleFactor(element.offsetWidth, element.offsetHeight) },
                jsPDF: { unit: 'in', format: 'letter', orientation: 'landscape' },
            };
            html2pdf().set(options).from(element).save();
        }
        function getScaleFactor(width, height) {
            const maxWidth = 8.5; // Letter size width in inches
            const maxHeight = 11; // Letter size height in inches
            const widthScale = width / maxWidth;
            const heightScale = height / maxHeight;
            return Math.min(1, Math.min(widthScale, heightScale));
        }
    </script>
</body>

</html>
