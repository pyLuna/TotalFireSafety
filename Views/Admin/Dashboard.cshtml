@using TotalFireSafety.Models
@{
    ViewBag.Title = "Dashboard";
    Layout = "~/Views/AdminLayout.cshtml";
    ViewBag.Dash = "active";
}

<div class="main-content">
    <header>
        <h2>
            <label for="nav-toggle">
                <span class="las la-bars"></span>
            </label>
            Overview

        </h2>
    <right>      
                <button class="create-req-btn" title="CREATE ORDER">
                    <a onclick="openForm()">
                        Notification
                        <span class="las la-bell"></span>
                        <label class="notif-badge">5</label>
                    </a>
                </button>
        </right>
    </header>

    <main>

        <!-- REMOVE CIRCLES -->
        @*<div class="summary">
                <center>
                    <div class="summary-title">
                        <b>
                            Total Fire Safety Technologies Inc. Performance
                        </b>
                    </div>

                    <div class="sum-chart-card">
                        <div class="sum-cards">
                            <div class="sum-card-title">
                                <div class="sum-card-single">
                                    <div class="sum-card-container">
                                        <div class="sum-card-details">
                                            <div class="cicle">
                                                <div class="circle-container">
                                                    <div class="inv-circle-wrap">
                                                        <div class="inv-circle">
                                                            <div class="inv-mask inv-half">
                                                                <div class="inv">

                                                                </div>
                                                            </div>

                                                            <div class="inv-mask inv-full">
                                                                <div class="inv">

                                                                </div>
                                                            </div>

                                                        </div>

                                                        <div class="inv-inside-circle">
                                                            <label id="Inventory"></label>
                                                            <script>
                                                                var inventoryCount = @ViewBag.Inventory;
                                                                document.getElementById("Inventory").textContent = inventoryCount;
                                                            </script>
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <h3>INVENTORY</h3>
                                    </div>
                                </div>
                            </div>

                            <div class="sum-card-title">
                                <div class="sum-card-single">
                                    <div class="sum-card-container">
                                        <div class="sum-card-details">
                                            <div class="cicle">
                                                <div class="circle-container">
                                                    <div class="inv-circle-wrap">
                                                        <div class="inv-circle">
                                                            <div class="inv-mask inv-half">
                                                                <div class="inv">

                                                                </div>
                                                            </div>

                                                            <div class="inv-mask inv-full">
                                                                <div class="inv">

                                                                </div>
                                                            </div>

                                                        </div>

                                                        <div class="inv-inside-circle"> 170 </div>

                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <h3>NUMBER OF PROJECTS</h3>
                                    </div>
                                </div>
                            </div>




                        </div>
                    </div>
                </center>
            </div>*@

        <div class="cards">
            @if (Int32.Parse(Session["system_role"].ToString()) == 1 || Int32.Parse(Session["system_role"].ToString()) == 2)
            {
                <div class="card-title">
                    <a href="@Url.Action("Inventory", "Admin")">
                        <h3>Inventory</h3>

                        <div class="card-single">
                            <div class="card-container">
                                <h3>Items</h3>
                                <div class="card-details">
                                    <label id="totalitem"></label><span>Total Items</span>
                                                                  <script>
                             var inventory = @ViewBag.Inventory;
                                        document.getElementById("totalitem").textContent = inventory;
                                                                  </script>
                                    <p></p>
                                    <label id="archiveitem" class="card-active"></label><span class="card-active">Active Items</span>
                                    <script>
                             var archive = @ViewBag.archive;
                                        document.getElementById("archiveitem").textContent = archive;
                                    </script>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            }
            @if (Int32.Parse(Session["system_role"].ToString()) != 2)
            {
                <div class="card-title">
                    <a href="@Url.Action("Users", "Admin")">
                        <h3>Users</h3>
                        <div class="card-single">
                            <div class="card-container">
                                <h3>Users</h3>
                                <div class="card-details">
                                    <label id="totaluser"></label><span>Total Users</span>
                                    <script>
                             var dataCount = @ViewBag.DataCount;
                                        document.getElementById("totaluser").textContent = dataCount;
                                    </script>
                                    <p></p>
                                    <label id="activeuser" class="card-active"></label><span class="card-active">Active Users</span>
                                    <script>
                             var Active = @ViewBag.active;
                                        document.getElementById("activeuser").textContent = Active;
                                    </script>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            }
                <div class="card-title">
                    <a href="@Url.Action("Requisition","Admin")">
                        <h3>Requisition</h3>
                        <div class="card-single">
                            <div class="card-container">
                                <h3>Purchase Request</h3>
                                <div class="card-details">
                                    <label id="purchase"></label><span>Total Entries</span>
                                    <script>
                                    var purchase = @ViewBag.Purchase;
                                    document.getElementById("purchase").textContent = purchase;
                                    </script>
                                    <p></p>
                                    <label class="card-active" id="entries"></label><span class="card-active">Pending Entries</span>
                                    <script>
                                    var entries = @ViewBag.Entries;
                                    document.getElementById("entries").textContent = entries;
                                    </script>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="card-title">
                    <a href="@Url.Action("Requisition","Admin")">
                        <h3>Deploy</h3>
                        <div class="card-single">
                            <div class="card-container">
                                <h3>Deployment Request</h3>
                                <div class="card-details">
                                    <label id="deployment"></label><span>Total Entries</span>
                                    <script>
                                    var deployment = @ViewBag.Deployment;
                                    document.getElementById("deployment").textContent = deployment;
                                    </script>
                                    <p></p>
                                    <label class="card-active" id="entrieses"></label><span class="card-active">Pending Entries</span>
                                    <script>
                                    var entrieses = @ViewBag.Entrieses;
                                    document.getElementById("entrieses").textContent = entrieses;
                                    </script>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>

                <!-- NEW ADD CARD -->
                <div class="card-title">
                    <a href="@Url.Action("Requisition","Admin")">
                        <h3>Supply</h3>
                        <div class="card-single">
                            <div class="card-container">
                                <h3>Supply Request</h3>
                                <div class="card-details">
                                    <label id="supply"></label><span>Total Entries</span>
                                    <script>
                                    var supply = @ViewBag.Supply;
                                    document.getElementById("supply").textContent = supply;
                                    </script>
                                    <p></p>
                                    <label class="card-active" id="Sup"></label><span class="card-active">Pending Entries</span>
                                    <script>
                                    var Sup = @ViewBag.Sup;
                                    document.getElementById("Sup").textContent = Sup;
                                    </script>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>

            </div>

        <div class="recent-grid">

            <div class="inventory-sum">
                <div class="inv-sum-header">
                    <h3>Inventories</h3>

                    <div class="inv-sum-date">
                        <div class="sum-date-con">
                            <label></label>
                            <input type="date" id="startDate">
                            <label>-</label>
                            <input type="date" id="endDate">
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">


                        <h3>Item Categories Summary</h3>

                        <div class="cat-grp">

                            <!-- NEW UPDATE-->

                            <input list="mylist" id="itemName" placeholder="Choose Item">
                            <datalist id="mylist">
                            </datalist>

                            <!-- END -->

                            <select id="itemCategory" required>
                                <option value="Clear" disabled selected>Item Category</option>
                                <option value="Fire Extinguisher">Fire Extinguisher</option>
                                <option value="Power Tools">Power Tools</option>
                                <option value="Fittings">Fittings</option>
                                <option value="Scaffolding">Scaffolding</option>
                                <option value="Others">Others</option>
                                <option value="Clear">Clear</option>
                            </select>

                            <select id="class" required>
                                <option value="All" disabled selected>Item Class</option>
                                <option value="All">All</option>
                                <option value="Local">Local</option>
                                <option value="Import">Import</option>
                            </select>

                        </div>

                    </div>
                    <div class="chart-border">
                        <div class="chart">
                            <canvas id="barchart" width="250" height="300"></canvas>
                            <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                            <script> var data = @Html.Raw(Json.Encode(ViewBag.Data));</script>
                            <script src="@Url.Content("~/Scripts/js/mainchart1.js")"></script>



                        </div>
                    </div>

                    <div class="card-headers">
                        <a href="@Url.Action("Inventory","Admin")"><button> See more <span class="las la-arrow-right"></span></button></a>
                        <div class="legend-grp">
                            <div class="legend-content">
                                <h3>Legend: </h3>
                                <div class="legend-content-1">
                                    <div class="legend-color">

                                    </div>
                                    <label> Standard </label>
                                </div>

                                <div class="legend-content-2">
                                    <div class="legend-color">

                                    </div>
                                    <label> Average </label>
                                </div>

                                <div class="legend-content-3">
                                    <div class="legend-color">

                                    </div>
                                    <label> Critical </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="inventory-sum">

                <h3>

                    <div class="inv-sum-date2">
                        <div class="sum-date-con">
                            <label></label>
                            <input type="date" id="startDate1">
                            <label>-</label>
                            <input type="date" id="endDate1">
                        </div>
                    </div>

                </h3>

                <div class="card">
                    <div class="card-header">
                        <h3>Moving Items</h3>

                        <div class="fst-grp">
                            <select id="moving" required>
                                <option disabled selected>Choose</option>
                                <option id="all">all</option>
                                <option id="fast">Fast Moving Item</option>
                                <option id="slow">Slow Moving Item</option>
                            </select>
                        </div>
                        <div class="project-sum-btns"></div>
                    </div>

                    <div class="chart-borders">
                        <div class="chart">
                            <div class="scatter">
                                <canvas id="charta" width="auto" height="auto"></canvas>
                                <script> var data1 = @Html.Raw(Json.Encode(ViewBag.Chart));</script>
                                <script src="@Url.Content("~/Scripts/js/barchart.js")"></script>


                            </div>

                        </div>
                    </div>

                    <div class="card-headers">
                        <div class="fst-legend-content">
                            <div class="fst-content-1">

                            </div>
                            <label> Fast Moving Item </label>
                            <div class="slw-content-1">

                            </div>
                            <label> Slow Moving Item </label>
                        </div>

                        <label class="fst-date"></label>
                    </div>

                </div>
            </div>


        </div>

        <!-- Project Summary -->

        <br>

        <div class="project-sum">
            <h3>PROJECT SUMMARY</h3>
        </div>

            <div class="dsh-projects">
                <div class="dsh">
                    <div class="drp-wrapper">
                        <select required>
                            <option disabled selected>Project Status</option>
                            <option>On-going</option>
                            <option>In-line</option>
                            <option>Delayed</option>
                        </select>

                        <select required>
                            <option disabled selected>Project Lead</option>
                            <option>Clarisse Vasquez</option>
                        </select>
                    </div>
                    <div class="dsh-body">
                        <div class="table-responsive" style="overflow-x: auto;">
                            <table width="100%">
                                <thead>
                                    <tr>
                                        <td>Project Name</td>
                                        <td>Project Lead</td>
                                        <td>Start Date</td>
                                        <td>Status</td>
                                        <td>Tracker</td>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Makati Global</td>
                                        <td>Jewell Mayrena</td>
                                        <td>Feb 27, 2023</td>
                                        <td><label class="stat-pen">In-Line</label></td>
                                        <td>
                                            <div class="progress-bar">
                                                <div class="progress-complete">
                                                </div>
                                            </div>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td>Mang Inasal QCU</td>
                                        <td>Fernan Yuki</td>
                                        <td>Feb 12, 2023</td>
                                        <td><label class="stat-appr">On-Going</label></td>
                                        <td>
                                            <div class="progress-bar">
                                                <div class="progress-half">
                                                </div>
                                            </div>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td>Golden Disk</td>
                                        <td>Carlo Millonte</td>
                                        <td>Jan 27, 2023</td>
                                        <td><label class="stat-appr">On-Going</label></td>
                                        <td>
                                            <div class="progress-bar">
                                                <div class="progress-halfhalf">
                                                </div>
                                            </div>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td>Jollibee South Branch</td>
                                        <td>Clark Steven Arcilla</td>
                                        <td>Feb 23, 2023</td>
                                        <td><label class="stat-dec">Declined</label></td>
                                        <td>
                                            <div class="progress-bar">
                                                <div class="progress-nothalf">
                                                </div>
                                            </div>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td>Jollibee South Branch</td>
                                        <td>Clark Steven Arcilla</td>
                                        <td>Feb 23, 2023</td>
                                        <td><label class="stat-dec">Declined</label></td>
                                        <td>
                                            <div class="progress-bar">
                                                <div class="progress-nothalf">
                                                </div>
                                            </div>
                                        </td>
                                    </tr>


                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="proj-legend-grp">
                        <div class="proj-legend-content">
                            <h3>Legend: </h3>
                            <div class="proj-legend-content-1">
                                <div class="legend-color">

                                </div>
                                <label> Ongoing </label>
                            </div>
                            <div class="proj-legend-content-2">
                                <div class="legend-color">

                                </div>
                                <label> Delayed </label>
                            </div>

                            <div class="proj-legend-content-3">
                                <div class="legend-color">

                                </div>
                                <label> Inline </label>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        

        </main>
</div>

@*<script src="../js/chart1.js"></script>
    <script src="../js/chart3.js"></script>*@
@Scripts.Render("~/script/admin")

<script>
    // get data from ViewBag

    // define function to filter data based on category
    function filterData(category) {
        return data.filter(function(item) {
            return item.Category == category;
        });
    }

    // define function to populate datalist with filtered names
    function populateDatalist(names) {
        var options = '';
        names.forEach(function(name) {
            options += '<option value="' + name + '">';
        });
        $('#mylist').html(options);
    }

    // listen for change in select element
    $('#itemCategory').on('change', function() {
        var category = $(this).val();
        var filteredData = filterData(category);
        var names = filteredData.map(function(item) {
            return item.Name;
        });
        populateDatalist(names);
    });
</script>


<script>
    `use strict`;
    var connection = $.hubConnection();
    var hubProxy = connection.createHubProxy('MyHub');

    window.onload = function () {
        connection.start().done(function () {
            // The connection has been established successfully
            console.log('Connection started');

            // Now you can send data through the connection
            var c = hubProxy.invoke("AddToGroup", '@Session["emp_no"]')
            console.log(c);
        }).fail(function () {
            // An error occurred while starting the connection
            console.log('Connection failed');
        });

    }
    //function refreshTime() {
    //    const timeDisplay = document.getElementById("dt");
    //    const dateString = new Date().toLocaleString();
    //    const formattedString = dateString.replace(", ", " - ");
    //    timeDisplay.textContent = formattedString;
    //}
    //setInterval(refreshTime, 0);


    var dropdown = document.getElementsByClassName("oper-dropdown-bt");
    var i;

    for (i = 0; i < dropdown.length; i++) {
        dropdown[i].addEventListener("click", function () {
            this.classList.toggle("active");
            var dropdownContent = this.nextElementSibling;
            if (dropdownContent.style.display === "block") {
                dropdownContent.style.display = "none";
            } else {
                dropdownContent.style.display = "block";
            }
        });
    }

    /* When the user clicks on the button,
       toggle between hiding and showing the dropdown content */


</script>
